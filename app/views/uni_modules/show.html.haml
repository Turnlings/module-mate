.page-heading  
  %nav
    %ol.breadcrumb
      %li.breadcrumb-item= link_to @semester.year.name, @semester.year
      %li.breadcrumb-item= link_to @semester.name, @semester 
      %li.breadcrumb-item.active= @uni_module.name
  .button-row
    = button_to pin_uni_module_path(@uni_module), method: :patch, class: 'icon-button', title: (@uni_module.pinned? ? 'Unpin module' : 'Pin module') do
      - if @uni_module.pinned?
        .icon-button
          %i.fa-solid.fa-thumbtack
      - else
        .icon-button.unselected
          %i.fa-solid.fa-thumbtack
    .icon-button
      = link_to edit_uni_module_path(@uni_module) do
        %i.fa-solid.fa-pen-to-square

-# Stats
.stats-container 
  .stat 
    .stat-header Credits
    .stat-content= number_with_precision(@uni_module.credits, precision: 0)
  .stat 
    .stat-header Weighted Average
    .stat-content= number_with_precision(@uni_module.weighted_average(current_user), precision: 2) + '%'
  .stat 
    .stat-header Achieved Score
    .stat-content= number_with_precision(@uni_module.achieved_score(current_user), precision: 2) + '%'

.exams-container
  .exams 
    .gt-empty-card
      = render 'exams'
  .graph-split
    .gt-empty-card
      .heading
        %h2 Assessment Split
      .body
        .chart-container
          = pie_chart @exam_data, legend: false, width: "100%", library: { aspectRatio: "1|1" }, id: 'exam-chart'

-# Graph
.gt-empty-card
  .heading
    .mini-stat
      .title Minutes Spent
      .figure= @uni_module.total_minutes

    = form_with url: request.path,
                method: :get,
                local: true,
                html: { class: "gt-form cumulative-toggle-form" } do |f|

      = f.select :cumulative,
          [["Cumulative", "true"], ["Daily", "false"]],
          { selected: params[:cumulative] || "true" },
          { onchange: "this.form.submit()", class: "cumulative-dropdown text-muted" }

  .body
    .chart-container
      = line_chart time_module_path(uni_module_id: @uni_module.id, cumulative: params[:cumulative]), curve: false, legend: false, width: "100%" #, height:"100%"
      
.row
  .col
    = render 'timelogs'